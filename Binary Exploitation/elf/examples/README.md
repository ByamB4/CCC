## Buffer overflow

**Example 1:**

- Solution: NX disabled, copy shellcode to stack.
- [Source code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/buffer-overflow-shellcode-1.c)
- [Solution code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/buffer-overflow-shellcode-1.py)

```c
char buffer[64];

gets(buffer);
```

**Example 2:**

- Solution: Jump to function with arguments 32bit.
- [Source code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/buffer-overflow-jump-1.c)
- [Solution code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/buffer-overflow-jump-1.py)

```c
char flag(int a1, int a2)
{
  if (a1 == 0xDEADBEEF && a2 == 0xC0DED00D)
    printf(FLAG);
}
```

**Example 3:**

- Solution: Copy shellcode to stack.
- [Source code]()
- [Solution code]()

```c
char buf[1024];

strcpy(buf, argv[1]);
```

**Example 4:**

- Solution: Change local variable, pass argument, fgets \x00
- [Source code]()
- [Solution code]()

```c
char user[32];
char pass[32];
char command[64];

printf("Username: ");
fgets(user, 31, stdin);
p = strchr(user, '\n');
if (p)
  *p = '\0';
if (strcmp(user, u.name))
  return 0;
printf("Password: ");
fgets(pass, 31, stdin);
p = strchr(pass, '\n');
if (p)
  *p = '\0';
if (strcmp(pass, u.pass))
  return 0;
printf("Command: ");
if (fgets(command, 128, stdin) == NULL)
  return 0;
p = strchr(command, '\n');
if (p)
  *p = '\0';
if (!strcmp(user, "root"))
{
  printf("Good job!\n");
  printf("command: %s\n", command);
  setresuid(geteuid(), geteuid(), geteuid());
  execve(shell[0], shell, 0);
}
```

## Format string

**Example 1:**

- [Source code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/format-string-1.c)
- [Solution code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/format-string-1.py)

```c
int var;
int check  = 0x04030201;

char fmt[128];

if (argc <2)
  exit(0);

memset( fmt, 0, sizeof(fmt) );

printf( "check at 0x%x\n", &check );
printf( "argv[1] = [%s]\n", argv[1] );

snprintf( fmt, sizeof(fmt), argv[1] );

if ((check != 0x04030201) && (check != 0xdeadbeef))
  printf ("\nYou are on the right way !\n");

printf( "fmt=[%s]\n", fmt );
printf( "check=0x%x\n", check );

if (check==0xdeadbeef) {
  printf("Yeah dude ! You win !\n");
  setreuid(geteuid(), geteuid());
  system("/bin/bash");
}
```

## ROP

**Example 1:**

- Call 3 functions with 3 arguments 32 bit. using gadget
- [Source code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/format-string-1.c)
- [Solution code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/format-string-1.py)

```c
callme_one(0xdeadbeef, 0xcafebabe, 0xd00df00d);
callme_two(0xdeadbeef, 0xcafebabe, 0xd00df00d);
callme_three(0xdeadbeef, 0xcafebabe, 0xd00df00d);
```

## BSS buffer overflow

BSS data segment is where to store global variables.

**Example 1:**

- [Source code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/bss-overflow-1.c)
- [Solution code](https://github.com/ByamB4/CCC/blob/master/Binary%20Exploitation/examples/src/bss-overflow-1.py)

```c
char username[512] = {1};
void (*_atexit)(int) = exit;

void cp_username(char *name, const char *arg)
{
  while ((*(name++) = *(arg++)))
    ;
  *name = 0;
}

int main(int argc, char **argv)
{
  if (argc != 2)
  {
    printf("[-] Usage : %s <username>\n", argv[0]);
    exit(0);
  }

  cp_username(username, argv[1]);
  printf("[+] Running program with username : %s\n", username);

  _atexit(0);
  return 0;
}
```
